flowchart TB
    subgraph Config[Deployment Configurations]
        direction TB
        
        subgraph Prod[Production: AWS Native]
            ProdL3[DurableTier&lt;S3Blob, DdbIndex&gt;]
            ProdBlob[S3Blob<br/>• AWS S3<br/>• Multi-region<br/>• 99.999999999% durability]
            ProdIndex[DdbIndex<br/>• DynamoDB<br/>• On-demand billing<br/>• Native TTL]
            ProdL3 --> ProdBlob
            ProdL3 --> ProdIndex
        end
        
        subgraph Global[Global: CockroachDB]
            GlobalL3[DurableTier&lt;S3Blob, CrdbIndex&gt;]
            GlobalBlob[S3Blob<br/>• AWS S3<br/>• Same as prod]
            GlobalIndex[CrdbIndex<br/>• CockroachDB<br/>• Multi-region ACID<br/>• Strong consistency]
            GlobalL3 --> GlobalBlob
            GlobalL3 --> GlobalIndex
        end
        
        subgraph OnPrem[On-Premise: Self-Hosted]
            OnPremL3[DurableTier&lt;CephBlob, CrdbIndex&gt;]
            OnPremBlob[CephBlob<br/>• Ceph RGW<br/>• S3-compatible<br/>• Local hardware]
            OnPremIndex[CrdbIndex<br/>• CockroachDB<br/>• Self-hosted cluster]
            OnPremL3 --> OnPremBlob
            OnPremL3 --> OnPremIndex
        end
        
        subgraph Dev[Development: Local]
            DevL3[DurableTier&lt;MinIOBlob, RedisIndex&gt;]
            DevBlob[MinIOBlob<br/>• MinIO<br/>• S3-compatible<br/>• Docker container]
            DevIndex[RedisIndex<br/>• Redis<br/>• Fast local KV<br/>• No persistence needed]
            DevL3 --> DevBlob
            DevL3 --> DevIndex
        end
        
        subgraph Hybrid[Hybrid: Best of Both]
            HybridL3[DurableTier&lt;MinIOBlob, DdbIndex&gt;]
            HybridBlob[MinIOBlob<br/>• MinIO on-prem<br/>• Cost savings<br/>• High bandwidth]
            HybridIndex[DdbIndex<br/>• DynamoDB<br/>• Managed service<br/>• Global consistency]
            HybridL3 --> HybridBlob
            HybridL3 --> HybridIndex
        end
    end
    
    subgraph Migration[Migration Path]
        direction LR
        Step1[1. Start: DynamoDB + S3<br/>DurableTier&lt;S3Blob, DdbIndex&gt;]
        Step2[2. Test: Add CockroachDB<br/>DurableTier&lt;S3Blob, CrdbIndex&gt;]
        Step3[3. Optimize: Move to Ceph<br/>DurableTier&lt;CephBlob, CrdbIndex&gt;]
        
        Step1 -->|No code changes<br/>Config only| Step2
        Step2 -->|No code changes<br/>Config only| Step3
    end
    
    subgraph Benefits[Key Benefits]
        B1[✓ Zero code changes<br/>between deployments]
        B2[✓ Test locally with MinIO<br/>Deploy to S3]
        B3[✓ Mix cloud + on-prem<br/>based on cost/latency]
        B4[✓ Vendor flexibility<br/>No lock-in]
        B5[✓ Gradual migration<br/>A/B test backends]
    end
    
    style ProdL3 fill:#F08080
    style GlobalL3 fill:#F08080
    style OnPremL3 fill:#F08080
    style DevL3 fill:#F08080
    style HybridL3 fill:#F08080
    
    style ProdBlob fill:#FFB6C6
    style GlobalBlob fill:#FFB6C6
    style OnPremBlob fill:#FFB6C6
    style DevBlob fill:#FFB6C6
    style HybridBlob fill:#FFB6C6
    
    style ProdIndex fill:#DDA0DD
    style GlobalIndex fill:#DDA0DD
    style OnPremIndex fill:#DDA0DD
    style DevIndex fill:#DDA0DD
    style HybridIndex fill:#DDA0DD
    
    style Step1 fill:#90EE90
    style Step2 fill:#87CEEB
    style Step3 fill:#DDA0DD
